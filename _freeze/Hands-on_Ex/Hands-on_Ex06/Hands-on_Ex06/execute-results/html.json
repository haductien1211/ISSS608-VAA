{
  "hash": "a4ee13edbeedecd84294ba5577490bf7",
  "result": {
    "markdown": "---\ntitle: \"Hands-on Exercise 6 Modelling, Visualising and Analysing Network Data with R\"\nauthor: \"Ha Duc Tien\"\ndate: \"May 14, 2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n# 1. Overview\n\nIn this hands-on exercise, we will learn how to model, analyse and visualise network data using R.\n\nBy the end of this hands-on exercise, you will be able to:\n\n-   create graph object data frames, manipulate them using appropriate functions of dplyr, lubridate, and tidygraph\n-   build network graph visualization using appropriate functions of ggraph\n-   compute network geometrics using tidygraph\n-   build advanced graph visualization by incorporating the network geometrics\n-   build interactive network visualization using visNetwork package.\n\n# 2. Getting started\n\n## 2.1 Installing and launching R packages\n\nWe will be using 4 network data modelling and visualization packages. They are igraph, tidygpraph, ggraph and visNetwork. Beside these four packages, tidyverse and libridate used for wrangling time data would also be used.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(igraph, tidygraph, ggraph, \n               visNetwork, clock,\n               tidyverse, graphlayouts)\n```\n:::\n\n\n## 2.2 The Data\n\nGAStech_email_edge.csv, GAStech_email_edge-v2.csv and GAStech_email_node.csv would be used.\n\n## 2.3 Importing the data\n\nGAStech_email_edge-v2.csv and GAStech_email_node.csv would be imported in this step using `read_csv`\n\nCode chunk:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGAStech_nodes <- read_csv(\"data/GAStech_email_node.csv\")\nGAStech_edges <- read_csv(\"data/GAStech_email_edge-v2.csv\")\n```\n:::\n\n\n# 3. Data Wrangling\n\n## 3.1 Reviewing the imported data\n\nUsing `glimpse()` we coud quickly examine the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(GAStech_edges)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 9,063\nColumns: 8\n$ source      <dbl> 43, 43, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 26, 26, 26…\n$ target      <dbl> 41, 40, 51, 52, 53, 45, 44, 46, 48, 49, 47, 54, 27, 28, 29…\n$ SentDate    <chr> \"6/1/2014\", \"6/1/2014\", \"6/1/2014\", \"6/1/2014\", \"6/1/2014\"…\n$ SentTime    <time> 08:39:00, 08:39:00, 08:58:00, 08:58:00, 08:58:00, 08:58:0…\n$ Subject     <chr> \"GT-SeismicProcessorPro Bug Report\", \"GT-SeismicProcessorP…\n$ MainSubject <chr> \"Work related\", \"Work related\", \"Work related\", \"Work rela…\n$ sourceLabel <chr> \"Sven.Flecha\", \"Sven.Flecha\", \"Kanon.Herrero\", \"Kanon.Herr…\n$ targetLabel <chr> \"Isak.Baza\", \"Lucas.Alcazar\", \"Felix.Resumir\", \"Hideki.Coc…\n```\n:::\n:::\n\n\n::: callout-warning\n## Warning\n\nOutput of GAStech_edges shown that *SentDate* is treated as \"Character\" instead of *date* data. This is an error and need to be fixed before we continue\n:::\n\n## 3.2 Wrangling time\n\nThe code chunk below will be used to perform the changes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGAStech_edges <- GAStech_edges %>%\n  mutate(SentDate = dmy(SentDate)) %>%\n  mutate(Weekday = wday(SentDate,\n                        label = TRUE,\n                        abbr = FALSE))\n```\n:::\n\n\n:::callout-note\n## Things to learn from the code chunk above\n\n-   both `dmy()` and `wday()` are functions of lubridate package. [lubridate](https://lubridate.tidyverse.org/) is an R package that makes it easier to work with dates and times.\n-   `dmy()` transforms the SentDate to Date data type.\n-   `wday()` returns the day of the week as a decimal number or an ordered factor if label is TRUE. The argument `abbr` is FALSE keep the daya spells in full, i.e. Monday. The function will create a new column in the data.frame i.e. Weekday and the output of `wday()` will save in this newly created field.\n-   the values in the *Weekday* field are in ordinal scale.\n:::\n\nTable below shows the data structure of the reformatted GAStech_edges data frame\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nRows: 9,063\nColumns: 9\n$ source      <dbl> 43, 43, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 26, 26, 26…\n$ target      <dbl> 41, 40, 51, 52, 53, 45, 44, 46, 48, 49, 47, 54, 27, 28, 29…\n$ SentDate    <date> 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-0…\n$ SentTime    <time> 08:39:00, 08:39:00, 08:58:00, 08:58:00, 08:58:00, 08:58:0…\n$ Subject     <chr> \"GT-SeismicProcessorPro Bug Report\", \"GT-SeismicProcessorP…\n$ MainSubject <chr> \"Work related\", \"Work related\", \"Work related\", \"Work rela…\n$ sourceLabel <chr> \"Sven.Flecha\", \"Sven.Flecha\", \"Kanon.Herrero\", \"Kanon.Herr…\n$ targetLabel <chr> \"Isak.Baza\", \"Lucas.Alcazar\", \"Felix.Resumir\", \"Hideki.Coc…\n$ Weekday     <ord> Monday, Monday, Monday, Monday, Monday, Monday, Monday, Mo…\n```\n:::\n:::\n\n\n## 3.3 Wrangling attributes\n\nA close examination of GAStech_edges data.frame reveals that it consists of individual e-mail flow records. This is not very useful for visualisation.\n\nIn view of this, we will aggregate the individual by date, senders, receivers, main subject and day of the week.\n\nThe code chunk:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGAStech_edges_aggregated <- GAStech_edges %>%\n  filter(MainSubject == \"Work related\") %>%\n  group_by(source, target, Weekday) %>%\n    summarise(Weight = n()) %>%\n  filter(source!=target) %>%\n  filter(Weight > 1) %>%\n  ungroup()\n```\n:::\n\n\n:::callout-note\n## Things to learn from the code chunk above\n\n-   four functions from **dplyr** package are used. They are: *filter()*, *group()*, *summarise()*, and *ungroup()*.\n-   The output data.frame is called **GAStech_edges_aggregated**.\n-   A new field called *Weight* has been added in GAStech_edges_aggregated.\n:::\n\nTable below shows the data structure of the reformatted GAStech_edges data frame\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,456\nColumns: 4\n$ source  <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ target  <dbl> 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7,…\n$ Weekday <ord> Monday, Tuesday, Wednesday, Friday, Monday, Tuesday, Wednesday…\n$ Weight  <int> 4, 3, 5, 8, 4, 3, 5, 8, 4, 3, 5, 8, 4, 3, 5, 8, 4, 3, 5, 8, 4,…\n```\n:::\n:::\n\n\n# 4. Creating network objects using tidygraph\n\nIn this section, you will learn how to create a graph data model by using tidygraph package. It provides a tidy API for graph/network manipulation. While network data itself is not tidy, it can be envisioned as two tidy tables, one for node data and one for edge data. tidygraph provides a way to switch between the two tables and provides dplyr verbs for manipulating them. Furthermore it provides access to a lot of graph algorithms with return values that facilitate their use in a tidy workflow.\n\nBefore getting started, read these two articles:\n\n[Introducing tidygraph](https://www.data-imaginist.com/posts/2017-07-07-introducing-tidygraph/)\n[tidygraph 1.1 - A tidy hope](https://www.data-imaginist.com/posts/2018-02-12-tidygraph-1-1-a-tidy-hope/index.html)\n\n## 4.1 The tbl_graph object\n\nTwo functions of tidygraph package can be used to create network objects, they are:\n\n[tbl_graph()](https://tidygraph.data-imaginist.com/reference/tbl_graph.html) creates a tbl_graph network object from nodes and edges data.\n\n[as_tbl_graph()](https://tidygraph.data-imaginist.com/reference/tbl_graph.html) converts network data and objects to a tbl_graph network. Below are network data and objects supported by as_tbl_graph()\n\n## 4.2 The dplyr verbs in tidygraph\n\n-   activate() verb from **tidygraph** serves as a switch between tibbles for nodes and edges. All dplyr verbs applied to **tbl_graph** object are applied to the active tibble.\n\n![](image3.jpg)\n\n-   In the above the *.N()* function is used to gain access to the node data while manipulating the edge data. Similarly *.E()* will give you the edge data and *.G()* will give you the **tbl_graph** object itself.\n\n\n\n## 4.3 Using tbl_graph() to build tidygraph data model\n\nIn this section, you will use tbl_graph() of tinygraph package to build an tidygraph’s network graph data.frame.\n\nBefore typing the codes, you are recommended to review to reference guide of [tbl_graph()](https://tidygraph.data-imaginist.com/reference/tbl_graph.html)\n\nCode chunk:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGAStech_graph <- tbl_graph(nodes = GAStech_nodes,\n                           edges = GAStech_edges_aggregated, \n                           directed = TRUE)\n```\n:::\n\n\nReviewing the output tidygraph’s graph object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGAStech_graph\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tbl_graph: 54 nodes and 1456 edges\n#\n# A directed multigraph with 1 component\n#\n# Node Data: 54 × 4 (active)\n      id label               Department     Title                               \n   <dbl> <chr>               <chr>          <chr>                               \n 1     1 Mat.Bramar          Administration Assistant to CEO                    \n 2     2 Anda.Ribera         Administration Assistant to CFO                    \n 3     3 Rachel.Pantanal     Administration Assistant to CIO                    \n 4     4 Linda.Lagos         Administration Assistant to COO                    \n 5     5 Ruscella.Mies.Haber Administration Assistant to Engineering Group Mana…\n 6     6 Carla.Forluniau     Administration Assistant to IT Group Manager       \n 7     7 Cornelia.Lais       Administration Assistant to Security Group Manager \n 8    44 Kanon.Herrero       Security       Badging Office                      \n 9    45 Varja.Lagos         Security       Badging Office                      \n10    46 Stenig.Fusil        Security       Building Control                    \n# ℹ 44 more rows\n#\n# Edge Data: 1,456 × 4\n   from    to Weekday   Weight\n  <int> <int> <ord>      <int>\n1     1     2 Monday         4\n2     1     2 Tuesday        3\n3     1     2 Wednesday      5\n# ℹ 1,453 more rows\n```\n:::\n:::\n\n\n-   The output above reveals that GAStech_graph is a tbl_graph object with 54 nodes and 4541 edges.\n-   The command also prints the first six rows of “Node Data” and the first three of “Edge Data”.\n-   It states that the Node Data is active. The notion of an active tibble within a tbl_graph object makes it possible to manipulate the data in one tibble at a time.\n\n\n## 4.4 Changing the active object\n\nThe nodes tibble data frame is activated by default, but you can change which tibble data frame is active with the *activate()* function. Thus, if we wanted to rearrange the rows in the edges tibble to list those with the highest “weight” first, we could use *activate()* and then *arrange()*.\n\nFor example,\n\nCode chunk\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGAStech_graph %>%\n  activate(edges) %>%\n  arrange(desc(Weight))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tbl_graph: 54 nodes and 1456 edges\n#\n# A directed multigraph with 1 component\n#\n# Edge Data: 1,456 × 4 (active)\n    from    to Weekday   Weight\n   <int> <int> <ord>      <int>\n 1    40    41 Tuesday       23\n 2    40    43 Tuesday       19\n 3    41    43 Tuesday       15\n 4    41    40 Tuesday       14\n 5    42    41 Tuesday       13\n 6    42    40 Tuesday       12\n 7    42    43 Tuesday       11\n 8    43    42 Wednesday     11\n 9    36    32 Wednesday      9\n10    40    41 Monday         9\n# ℹ 1,446 more rows\n#\n# Node Data: 54 × 4\n     id label           Department     Title           \n  <dbl> <chr>           <chr>          <chr>           \n1     1 Mat.Bramar      Administration Assistant to CEO\n2     2 Anda.Ribera     Administration Assistant to CFO\n3     3 Rachel.Pantanal Administration Assistant to CIO\n# ℹ 51 more rows\n```\n:::\n:::\n\n\n\nVisit the reference guide of [*activate()*](https://tidygraph.data-imaginist.com/reference/activate.html) to find out more about the function.\n\n# 5 Plotting Static Network Graphs with ggraph package\n\n[ggraph](https://ggraph.data-imaginist.com/) is an extension of ggplot2, making it easier to carry over basic ggplot skills to the design of network graphs.\n\nAs in all network graph, there are three main aspects to a ggraph’s network graph, they are:\n\n-   [nodes](https://cran.r-project.org/web/packages/ggraph/vignettes/Nodes.html)\n-   [edges](https://cran.r-project.org/web/packages/ggraph/vignettes/Edges.html)\n-   [layouts](https://cran.r-project.org/web/packages/ggraph/vignettes/Layouts.html)\nFor a comprehensive discussion of each of this aspect of graph, please refer to their respective vignettes provided.\n\n## 5.1 Plotting Static Network Graphs with ggraph package\n\nThe code chunk below uses [*ggraph()*](https://ggraph.data-imaginist.com/reference/ggraph.html), [*geom-edge_link()*](https://ggraph.data-imaginist.com/reference/geom_edge_link.html) and [*geom_node_point()*](https://ggraph.data-imaginist.com/reference/geom_node_point.html) to plot a network graph by using *GAStech_graph*. Before your get started, it is advisable to read their respective reference guide at least once.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\nggraph(GAStech_graph) +\n  geom_edge_link() +\n  geom_node_point()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n:::callout-note\n## Things to learn from the code chunk above:\n\nThe basic plotting function is `ggraph()`, which takes the data to be used for the graph and the type of layout desired. Both of the arguments for `ggraph()` are built around igraph. Therefore, `ggraph()` can use either an igraph object or a tbl_graph object.\n:::\n\n\n## 5.2 Changing the default network graph theme\n\nIn this section, you will use [theme_graph()](https://ggraph.data-imaginist.com/reference/theme_graph.html) to remove the x and y axes. Before your get started, it is advisable to read it’s reference guide at least once.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- ggraph(GAStech_graph) + \n  geom_edge_link(aes()) +\n  geom_node_point(aes())\n\ng + theme_graph()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n:::callout-tip\n## Things to learn from the code chunk above:\n\n-   **ggraph** introduces a special ggplot theme that provides better defaults for network graphs than the normal ggplot defaults. `theme_graph()`, besides removing axes, grids, and border, changes the font to Arial Narrow (this can be overridden).\n\n-   The ggraph theme can be set for a series of plots with the `set_graph_style()` command run before the graphs are plotted or by using `theme_graph()` in the individual plots.\n:::\n\n## 5.3 Changing the coloring of the plot\n\nFurthermore, `theme_graph()` makes it easy to change the coloring of the plot.\n\nCode chunk\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- ggraph(GAStech_graph) + \n  geom_edge_link(aes(colour = 'grey50')) +\n  geom_node_point(aes(colour = 'grey40'))\n\ng + theme_graph(background = 'grey10',\n                text_colour = 'white')\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n## 5.4 Working with ggraph’s layouts\n\n**ggraph** support many layout for standard used, they are: star, circle, nicely (default), dh, gem, graphopt, grid, mds, spahere, randomly, fr, kk, drl and lgl. Figures below and on the right show layouts supported by `ggraph()`.\n\n![](image5.jpg)\n\n\n## 5.5 Fruchterman and Reingold layout\n\nThe code chunks below will be used to plot the network graph using Fruchterman and Reingold layout.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\ng <- ggraph(GAStech_graph, \n            layout = \"fr\") +\n  geom_edge_link(aes()) +\n  geom_node_point(aes())\n\ng + theme_graph()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n:::callout-tip\nThing to learn from the code chunk above:\n\n-   *layout* argument is used to define the layout to be used.\n:::\n## 5.6 Modifying network nodes\n\nIn this section, you will colour each node by referring to their respective departments.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- ggraph(GAStech_graph, \n            layout = \"nicely\") + \n  geom_edge_link(aes()) +\n  geom_node_point(aes(colour = Department, \n                      size = 3))\n\ng + theme_graph()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n:::callout-tip\n\nThings to learn from the code chunks above:\n\n-   *geom_node_point* is equivalent in functionality to geo_point of ggplot2. It allows for simple plotting of nodes in different shapes, colours and sizes. In the codes chnuks above colour and size are used\n:::\n\n## 5.7  Modifying edges\n\nIn the code chunk below, the thickness of the edges will be mapped with the *Weight* variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\ng <- ggraph(GAStech_graph, \n            layout = \"nicely\") +\n  geom_edge_link(aes(width = Weight), \n                 alpha = 0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department), \n                  size = 3)\n\ng + theme_graph()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n:::callout-tip\n## Things to learn from the code chunks above:\n\n-   *geom_edge_link* draws edges in the simplest way - as straight lines between the start and end nodes. But, it can do more that that. In the example above, argument width is used to map the width of the line in proportional to the Weight attribute and argument alpha is used to introduce opacity on the line.\n:::\n\n# 6. Creating facet graphs\n\nAnother very useful feature of **ggraph** is faceting. In visualising network data, this technique can be used to reduce edge over-plotting in a very meaning way by spreading nodes and edges out based on their attributes. In this section, you will learn how to use faceting technique to visualise network data.\n\nThere are three functions in ggraph to implement faceting, they are:\n\n-   [facet_nodes()](https://ggraph.data-imaginist.com/reference/facet_nodes.html) whereby edges are only draw in a panel if both terminal nodes are present here,\n-   [facet_edges()](https://ggraph.data-imaginist.com/reference/facet_edges.html) whereby nodes are always drawn in al panels even if the node data contains an attribute named the same as the one used for the edge facetting, and\n-   [facet_graph()](https://ggraph.data-imaginist.com/reference/facet_graph.html) faceting on two variables simultaneously.\n\n## 6.1 Working with *facet_edges()*\n\nIn the code chunk below, `facet_edges()` is used. Before getting started, it is advisable for you to read it’s reference guide at least once.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset_graph_style()\n\ng <- ggraph(GAStech_graph, \n            layout = \"nicely\") + \n  geom_edge_link(aes(width = Weight), \n                 alpha = 0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department), \n                  size = 2)\n\ng + facet_edges(~Weekday)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n## 6.2 Changing the position of the legend\n\nThe code chunk below uses theme() to change the position of the legend.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset_graph_style()\n\ng <- ggraph(GAStech_graph, \n            layout = \"nicely\") + \n  geom_edge_link(aes(width = Weight), \n                 alpha = 0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department), \n                  size = 2) +\n  theme(legend.position = 'bottom')\n  \ng + facet_edges(~Weekday)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n## 6.3 A framed facet graph\n\nThe code chunk below adds frame to each graph.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset_graph_style() \n\ng <- ggraph(GAStech_graph, \n            layout = \"nicely\") + \n  geom_edge_link(aes(width=Weight),\n                 alpha = 0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department), \n                  size = 2)\n  \ng + facet_edges(~Weekday) +\n  th_foreground(foreground = \"grey80\",  \n                border = TRUE) +\n  theme(legend.position = 'bottom')\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n## 6.4 Working with facet_nodes()\n\nIn the code chunkc below, `facet_nodes()` is used. Before getting started, it is advisable for you to read it’s reference guide at least once.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset_graph_style()\n\ng <- ggraph(GAStech_graph, \n            layout = \"nicely\") + \n  geom_edge_link(aes(width = Weight), \n                 alpha = 0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department), \n                  size = 2)\n  \ng + facet_nodes(~Department)+\n  th_foreground(foreground = \"grey80\",  \n                border = TRUE) +\n  theme(legend.position = 'bottom')\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n# 7. Network Metrics Analysis\n\n## 7.1 Computing centrality indices\n\nCentrality measures are a collection of statistical indices use to describe the relative important of the actors are to a network. There are four well-known centrality measures, namely: degree, betweenness, closeness and eigenvector. It is beyond the scope of this hands-on exercise to cover the principles and mathematics of these measure here. Refer to Chapter 7: Actor Prominence of A User’s Guide to Network Analysis in R to gain better understanding of theses network measures.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- GAStech_graph %>%\n  mutate(betweenness_centrality = centrality_betweenness()) %>%\n  ggraph(layout = \"fr\") + \n  geom_edge_link(aes(width = Weight),\n                 alpha = 0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department,\n                      size = betweenness_centrality))\ng + theme_graph()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n:::callout-tip\n##Things to learn from the code chunk above:\n\nmutate() of dplyr is used to perform the computation.\n:::\n\n## 7.2 Visualising network metrics\n\nIt is important to note that from ggraph v2.0 onward tidygraph algorithms such as centrality measures can be accessed directly in ggraph calls. This means that it is no longer necessary to precompute and store derived node and edge centrality measures on the graph in order to use them in a plot.\nthe algorithm used, on the other hand, is the centrality_betweenness() of tidygraph.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- GAStech_graph %>%\n  ggraph(layout = \"fr\") + \n  geom_edge_link(aes(width = Weight), \n                 alpha = 0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department, \n                      size = centrality_betweenness()))\ng + theme_graph()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n## 7.3 Visualizing community\n\ntidygraph package inherits many of the community detection algorithms imbedded into igraph and makes them available to us, including `Edge-betweenness (group_edge_betweenness)`, `Leading eigenvector (group_leading_eigen)`, `Fast-greedy (group_fast_greedy)`, `Louvain (group_louvain)`, `Walktrap (group_walktrap)`, `Label propagation (group_label_prop)`, `InfoMAP (group_infomap)`, `Spinglass (group_spinglass)`, and `Optimal (group_optimal)`. Some community algorithms are designed to take into account direction or weight, while others ignore it. Use this [link](https://tidygraph.data-imaginist.com/reference/group_graph.html) to find out more about community detection functions provided by tidygraph,\n\nIn the code chunk below `group_edge_betweenness()` is used.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- GAStech_graph %>%\n  mutate(community = as.factor(group_edge_betweenness(weights = Weight, directed = TRUE))) %>%\n  ggraph(layout = \"fr\") + \n  geom_edge_link(aes(width=Weight), \n                 alpha=0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = community))  \n\ng + theme_graph()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n# 8 Building Interactive Network Graph with visNetwork\n\n-   [visNetwork()](https://datastorm-open.github.io/visNetwork/) is a R package for network visualization, using [vis.js](https://visjs.org/) javascript library.\n\n-   visNetwork() function uses a nodes list and edges list to create an interactive graph.\n\n-       The nodes list must include an “id” column, and the edge list must have “from” and “to” columns.\n-       The function also plots the labels for the nodes, using the names of the actors from the “label” column in the node list.\n\n-   The resulting graph is fun to play around with.\n\n-       You can move the nodes and the graph will use an algorithm to keep the nodes properly spaced.\n-       You can also zoom in and out on the plot and move it around to re-center it.\n\n## 8.1 Data preparation\n\nBefore we can plot the interactive network graph, we need to prepare the data model by using the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGAStech_edges_aggregated <- GAStech_edges %>%\n  left_join(GAStech_nodes, by = c(\"sourceLabel\" = \"label\")) %>%\n  rename(from = id) %>%\n  left_join(GAStech_nodes, by = c(\"targetLabel\" = \"label\")) %>%\n  rename(to = id) %>%\n  filter(MainSubject == \"Work related\") %>%\n  group_by(from, to) %>%\n    summarise(weight = n()) %>%\n  filter(from!=to) %>%\n  filter(weight > 1) %>%\n  ungroup()\n```\n:::\n\n\n## 8.2 Plotting the first interactive network graph\n\nThe code chunk below will be used to plot an interactive network graph by using the data prepared.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvisNetwork(GAStech_nodes, \n           GAStech_edges_aggregated)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-895fa95febc559fc9236\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-895fa95febc559fc9236\">{\"x\":{\"nodes\":{\"id\":[1,2,3,4,5,6,7,44,45,46,8,9,10,11,12,13,14,15,16,21,26,17,18,19,20,39,40,41,42,43,27,28,29,47,48,49,50,22,51,52,53,54,23,24,25,30,31,32,33,34,35,36,37,38],\"label\":[\"Mat.Bramar\",\"Anda.Ribera\",\"Rachel.Pantanal\",\"Linda.Lagos\",\"Ruscella.Mies.Haber\",\"Carla.Forluniau\",\"Cornelia.Lais\",\"Kanon.Herrero\",\"Varja.Lagos\",\"Stenig.Fusil\",\"Marin.Onda\",\"Axel.Calzas\",\"Brand.Tempestad\",\"Elsa.Orilla\",\"Isande.Borrasca\",\"Kare.Orilla\",\"Felix.Balas\",\"Lars.Azada\",\"Lidelse.Dedos\",\"Willem.Vasco-Pais\",\"Bertrand.Ovan\",\"Adra.Nubarron\",\"Birgitta.Frente\",\"Gustav.Cazar\",\"Vira.Frente\",\"Linnea.Bergen\",\"Lucas.Alcazar\",\"Isak.Baza\",\"Nils.Calixto\",\"Sven.Flecha\",\"Emile.Arpa\",\"Varro.Awelon\",\"Dante.Coginian\",\"Edvard.Vann\",\"Hennie.Osvaldo\",\"Isia.Vann\",\"Minke.Mies\",\"Sten.Sanjorge.Jr\",\"Felix.Resumir\",\"Hideki.Cocinaro\",\"Inga.Ferro\",\"Loreto.Bodrogi\",\"Ingrid.Barranco\",\"Ada.Campo-Corrente\",\"Orhan.Strum\",\"Adan.Morlun\",\"Albina.Hafon\",\"Benito.Hawelon\",\"Cecilia.Morluniau\",\"Claudio.Hawelon\",\"Dylan.Scozzese\",\"Henk.Mies\",\"Irene.Nant\",\"Valeria.Morlun\"],\"Department\":[\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Security\",\"Security\",\"Security\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Executive\",\"Facilities\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Facilities\",\"Facilities\",\"Facilities\",\"Security\",\"Security\",\"Security\",\"Security\",\"Executive\",\"Security\",\"Security\",\"Security\",\"Security\",\"Executive\",\"Executive\",\"Executive\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\"],\"Title\":[\"Assistant to CEO\",\"Assistant to CFO\",\"Assistant to CIO\",\"Assistant to COO\",\"Assistant to Engineering Group Manager\",\"Assistant to IT Group Manager\",\"Assistant to Security Group Manager\",\"Badging Office\",\"Badging Office\",\"Building Control\",\"Drill Site Manager\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Engineer\",\"Engineer\",\"Engineering Group Manager\",\"Environmental Safety Advisor\",\"Facilities Group Manager\",\"Geologist\",\"Geologist\",\"Hydraulic Technician\",\"Hydraulic Technician\",\"IT Group Manager\",\"IT Helpdesk\",\"IT Technician\",\"IT Technician\",\"IT Technician\",\"Janitor\",\"Janitor\",\"Lead Janitor\",\"Perimeter Control\",\"Perimeter Control\",\"Perimeter Control\",\"Perimeter Control\",\"President/CEO\",\"Security Group Manager\",\"Site Control\",\"Site Control\",\"Site Control\",\"SVP/CFO\",\"SVP/CIO\",\"SVP/COO\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\"]},\"edges\":{\"from\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54],\"to\":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,3,4,5,6,7,15,36,38,1,2,4,5,6,7,48,1,2,3,5,6,7,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,2,3,4,5,7,28,1,2,3,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,27,8,10,11,12,13,14,15,16,17,18,19,20,45,8,9,11,12,13,14,15,16,17,18,19,20,8,9,10,12,13,14,15,16,17,18,19,20,32,8,9,10,11,13,14,15,16,17,18,19,20,52,8,9,10,11,12,14,15,16,17,18,19,20,8,9,10,11,12,13,15,16,17,18,19,20,2,8,9,10,11,12,13,14,16,17,18,19,20,8,9,10,11,12,13,14,15,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,8,9,10,11,12,13,14,15,17,19,20,8,9,10,11,12,13,14,15,16,17,18,20,8,9,10,11,12,13,14,15,16,17,18,19,50,22,23,24,25,53,21,23,24,25,36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,5,21,22,23,25,21,22,23,24,46,27,28,29,30,31,32,33,34,35,36,37,38,8,28,29,30,31,32,33,34,35,36,37,38,40,6,26,27,29,30,31,32,33,34,35,36,37,38,1,26,27,28,30,31,32,33,34,35,36,37,38,40,51,52,26,27,28,29,31,32,33,34,35,36,37,38,3,27,28,29,30,32,33,34,35,36,37,38,11,26,27,28,29,30,31,33,34,35,36,37,38,23,26,27,28,29,30,31,32,34,35,36,37,38,27,28,29,30,31,32,33,35,36,37,38,26,27,28,29,30,31,32,33,34,36,37,38,2,22,26,27,28,29,30,31,32,33,34,35,37,38,53,26,27,28,29,30,31,32,33,34,35,36,38,27,28,29,30,31,32,34,35,36,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,40,42,43,40,41,43,44,40,41,42,42,45,46,47,48,49,50,51,52,53,54,44,46,47,48,49,50,51,52,53,54,44,45,47,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,3,45,46,47,48,52,54,5,20,48,49,53,54,29,44,45,46,47,48,49,50,52,53,54,7,12,29,44,45,46,47,48,49,50,51,53,5,21,36,44,45,47,48,49,50,51,52,54,5,44,45,46,47,48,49,50,51,52,53],\"weight\":[21,21,21,21,21,21,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,6,6,6,6,6,9,2,2,2,8,8,8,8,8,8,2,12,12,12,12,12,12,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,11,11,11,11,11,11,3,12,15,12,12,12,12,3,4,3,3,4,4,3,3,4,3,4,3,3,4,4,9,4,7,7,11,5,4,5,6,8,3,8,8,7,9,9,6,9,10,10,7,5,7,11,10,11,6,11,7,11,9,10,7,10,8,3,9,10,8,8,11,6,7,5,3,6,5,6,2,9,5,10,7,7,4,3,4,7,2,3,3,6,5,7,4,6,6,7,5,7,6,3,4,3,6,13,8,8,5,6,6,11,9,6,2,7,6,8,7,5,5,7,6,7,7,5,4,6,2,2,2,2,2,2,2,6,4,7,7,6,6,6,6,5,5,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,5,3,3,2,5,2,3,2,4,8,5,9,6,5,4,10,7,4,4,5,5,10,5,7,4,5,4,4,4,3,2,4,3,4,2,4,7,2,7,5,10,4,2,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,6,10,17,9,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,5,9,7,3,8,2,3,4,2,26,25,25,25,25,25,24,25,25,26,25,26,3,4,3,6,4,3,3,6,5,3,4,5,3,3,2,3,6,5,8,6,6,7,4,6,6,6,2,2,6,5,7,5,6,5,7,6,6,5,5,3,2,3,3,5,7,9,12,9,9,6,13,12,9,11,2,5,4,6,6,9,7,6,12,7,7,8,4,2,8,6,9,7,10,7,9,6,10,5,8,2,4,2,3,5,7,8,4,7,5,7,6,4,5,6,4,7,8,5,9,6,6,10,6,3,11,7,9,11,15,7,11,11,9,13,13,2,2,3,12,11,12,16,15,19,12,11,14,11,13,3,3,4,5,6,7,7,6,9,10,7,5,3,2,5,5,2,2,2,4,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,2,2,40,22,30,2,2,2,2,2,2,2,2,2,2,2,28,19,24,25,19,28,2,15,16,24,3,4,2,5,6,2,5,5,2,6,3,6,4,2,6,5,5,4,7,5,6,6,3,4,9,5,6,8,7,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,5,4,3,7,5,6,6,5,5,5,2,2,4,2,4,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,5,3,8,6,5,5,5,6,2,3,2,3,3,4,2,2,4,2,2,5,2,3,3,3,3,4,4,2,3,3,3,3,2,2,4,2,4,4,3,4,5,3,2,4,3,3,4,3,3,2,5,4,8,2,2,5,2,3,4,3,2,5,4,4,2,3,4]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\"},\"manipulation\":{\"enabled\":false}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":false},\"byselection\":{\"enabled\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## 8.3  Working with layout\n\nIn the code chunk below, Fruchterman and Reingold layout is used.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvisNetwork(GAStech_nodes,\n           GAStech_edges_aggregated) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") \n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-cb2d121e582ccedba374\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-cb2d121e582ccedba374\">{\"x\":{\"nodes\":{\"id\":[1,2,3,4,5,6,7,44,45,46,8,9,10,11,12,13,14,15,16,21,26,17,18,19,20,39,40,41,42,43,27,28,29,47,48,49,50,22,51,52,53,54,23,24,25,30,31,32,33,34,35,36,37,38],\"label\":[\"Mat.Bramar\",\"Anda.Ribera\",\"Rachel.Pantanal\",\"Linda.Lagos\",\"Ruscella.Mies.Haber\",\"Carla.Forluniau\",\"Cornelia.Lais\",\"Kanon.Herrero\",\"Varja.Lagos\",\"Stenig.Fusil\",\"Marin.Onda\",\"Axel.Calzas\",\"Brand.Tempestad\",\"Elsa.Orilla\",\"Isande.Borrasca\",\"Kare.Orilla\",\"Felix.Balas\",\"Lars.Azada\",\"Lidelse.Dedos\",\"Willem.Vasco-Pais\",\"Bertrand.Ovan\",\"Adra.Nubarron\",\"Birgitta.Frente\",\"Gustav.Cazar\",\"Vira.Frente\",\"Linnea.Bergen\",\"Lucas.Alcazar\",\"Isak.Baza\",\"Nils.Calixto\",\"Sven.Flecha\",\"Emile.Arpa\",\"Varro.Awelon\",\"Dante.Coginian\",\"Edvard.Vann\",\"Hennie.Osvaldo\",\"Isia.Vann\",\"Minke.Mies\",\"Sten.Sanjorge.Jr\",\"Felix.Resumir\",\"Hideki.Cocinaro\",\"Inga.Ferro\",\"Loreto.Bodrogi\",\"Ingrid.Barranco\",\"Ada.Campo-Corrente\",\"Orhan.Strum\",\"Adan.Morlun\",\"Albina.Hafon\",\"Benito.Hawelon\",\"Cecilia.Morluniau\",\"Claudio.Hawelon\",\"Dylan.Scozzese\",\"Henk.Mies\",\"Irene.Nant\",\"Valeria.Morlun\"],\"Department\":[\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Security\",\"Security\",\"Security\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Executive\",\"Facilities\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Facilities\",\"Facilities\",\"Facilities\",\"Security\",\"Security\",\"Security\",\"Security\",\"Executive\",\"Security\",\"Security\",\"Security\",\"Security\",\"Executive\",\"Executive\",\"Executive\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\"],\"Title\":[\"Assistant to CEO\",\"Assistant to CFO\",\"Assistant to CIO\",\"Assistant to COO\",\"Assistant to Engineering Group Manager\",\"Assistant to IT Group Manager\",\"Assistant to Security Group Manager\",\"Badging Office\",\"Badging Office\",\"Building Control\",\"Drill Site Manager\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Engineer\",\"Engineer\",\"Engineering Group Manager\",\"Environmental Safety Advisor\",\"Facilities Group Manager\",\"Geologist\",\"Geologist\",\"Hydraulic Technician\",\"Hydraulic Technician\",\"IT Group Manager\",\"IT Helpdesk\",\"IT Technician\",\"IT Technician\",\"IT Technician\",\"Janitor\",\"Janitor\",\"Lead Janitor\",\"Perimeter Control\",\"Perimeter Control\",\"Perimeter Control\",\"Perimeter Control\",\"President/CEO\",\"Security Group Manager\",\"Site Control\",\"Site Control\",\"Site Control\",\"SVP/CFO\",\"SVP/CIO\",\"SVP/COO\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\"],\"x\":[-0.1717308689453994,-0.6530055940583674,-0.6046428742008814,-1,-0.1270238072990049,-0.830459806510074,-0.8839133274892411,0.8855310851801825,0.5558983404098059,0.7182538202946658,-0.6423635131585768,-0.5120375596749587,-0.602462841130135,-0.790481251784141,-0.5247390823084921,-0.9943740649041006,-0.9448657349449957,-0.9379345211849701,-0.7927256462833723,0.3997662740533121,0.3873226039638973,-0.216272666956745,-0.7372256590595002,-0.8138827889729084,-0.3871353914844979,-0.7299878106845692,-0.006372513562005855,0.822621087017942,1,0.9221506184997796,-0.1176602639122463,-0.2840919111475868,0.3342682968930129,0.03487346205782749,0.06734259803430187,0.5574792871190726,0.4563874013555715,0.1366935541528385,0.7528082347037164,0.2928744862293098,0.4942078988520799,0.7745528571947309,-0.05690593020465151,0.1651517115504271,-0.006310549819141587,0.1780822116786946,0.04034863912286135,-0.2596342410238324,-0.03373697643273454,0.05600035245291113,0.2469288505217275,0.1420210592765689,0.4126996056113359,-0.17262881611915],\"y\":[-0.0726517146280663,-0.4211989068777022,-0.2531827868535853,-0.3518908991451309,0.021922206240929,-0.5333801592129073,-0.1410647607057688,0.3942240888757427,0.3435520095127029,0.5298355247499424,0.3101932406975503,0.5105339371148288,0.8484289326378622,0.208001596225474,0.6545563316750902,0.4726042020682786,0.6470346800182216,0.2921036108737793,0.8025007941440421,0.9469861087979288,-0.9126432584406297,0.1190018433192528,0.6587540653874291,0.4928952645759579,0.7352931931863704,-0.8304074581910017,-0.08230470430725823,-0.4688924610511973,-0.05734186034331457,-0.2848723314942918,-0.5572308420133869,-0.8388403077819173,-0.5191218775071379,0.01220317138213267,0.08852473035946495,0.08429594315744193,0.6915188612716601,0.6840080469631764,0.05671654621105726,0.3538596324394627,0.4791773457316679,0.2661972168084858,0.1211256243570236,0.9638948598053843,1,-1,-0.7046852605302449,-0.6531220631931037,-0.9637606086601346,-0.8734499443549025,-0.7857946705391666,-0.4375458526462093,-0.7294758032393167,-0.9114807296418164]},\"edges\":{\"from\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54],\"to\":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,3,4,5,6,7,15,36,38,1,2,4,5,6,7,48,1,2,3,5,6,7,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,2,3,4,5,7,28,1,2,3,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,27,8,10,11,12,13,14,15,16,17,18,19,20,45,8,9,11,12,13,14,15,16,17,18,19,20,8,9,10,12,13,14,15,16,17,18,19,20,32,8,9,10,11,13,14,15,16,17,18,19,20,52,8,9,10,11,12,14,15,16,17,18,19,20,8,9,10,11,12,13,15,16,17,18,19,20,2,8,9,10,11,12,13,14,16,17,18,19,20,8,9,10,11,12,13,14,15,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,8,9,10,11,12,13,14,15,17,19,20,8,9,10,11,12,13,14,15,16,17,18,20,8,9,10,11,12,13,14,15,16,17,18,19,50,22,23,24,25,53,21,23,24,25,36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,5,21,22,23,25,21,22,23,24,46,27,28,29,30,31,32,33,34,35,36,37,38,8,28,29,30,31,32,33,34,35,36,37,38,40,6,26,27,29,30,31,32,33,34,35,36,37,38,1,26,27,28,30,31,32,33,34,35,36,37,38,40,51,52,26,27,28,29,31,32,33,34,35,36,37,38,3,27,28,29,30,32,33,34,35,36,37,38,11,26,27,28,29,30,31,33,34,35,36,37,38,23,26,27,28,29,30,31,32,34,35,36,37,38,27,28,29,30,31,32,33,35,36,37,38,26,27,28,29,30,31,32,33,34,36,37,38,2,22,26,27,28,29,30,31,32,33,34,35,37,38,53,26,27,28,29,30,31,32,33,34,35,36,38,27,28,29,30,31,32,34,35,36,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,40,42,43,40,41,43,44,40,41,42,42,45,46,47,48,49,50,51,52,53,54,44,46,47,48,49,50,51,52,53,54,44,45,47,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,3,45,46,47,48,52,54,5,20,48,49,53,54,29,44,45,46,47,48,49,50,52,53,54,7,12,29,44,45,46,47,48,49,50,51,53,5,21,36,44,45,47,48,49,50,51,52,54,5,44,45,46,47,48,49,50,51,52,53],\"weight\":[21,21,21,21,21,21,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,6,6,6,6,6,9,2,2,2,8,8,8,8,8,8,2,12,12,12,12,12,12,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,11,11,11,11,11,11,3,12,15,12,12,12,12,3,4,3,3,4,4,3,3,4,3,4,3,3,4,4,9,4,7,7,11,5,4,5,6,8,3,8,8,7,9,9,6,9,10,10,7,5,7,11,10,11,6,11,7,11,9,10,7,10,8,3,9,10,8,8,11,6,7,5,3,6,5,6,2,9,5,10,7,7,4,3,4,7,2,3,3,6,5,7,4,6,6,7,5,7,6,3,4,3,6,13,8,8,5,6,6,11,9,6,2,7,6,8,7,5,5,7,6,7,7,5,4,6,2,2,2,2,2,2,2,6,4,7,7,6,6,6,6,5,5,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,5,3,3,2,5,2,3,2,4,8,5,9,6,5,4,10,7,4,4,5,5,10,5,7,4,5,4,4,4,3,2,4,3,4,2,4,7,2,7,5,10,4,2,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,6,10,17,9,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,5,9,7,3,8,2,3,4,2,26,25,25,25,25,25,24,25,25,26,25,26,3,4,3,6,4,3,3,6,5,3,4,5,3,3,2,3,6,5,8,6,6,7,4,6,6,6,2,2,6,5,7,5,6,5,7,6,6,5,5,3,2,3,3,5,7,9,12,9,9,6,13,12,9,11,2,5,4,6,6,9,7,6,12,7,7,8,4,2,8,6,9,7,10,7,9,6,10,5,8,2,4,2,3,5,7,8,4,7,5,7,6,4,5,6,4,7,8,5,9,6,6,10,6,3,11,7,9,11,15,7,11,11,9,13,13,2,2,3,12,11,12,16,15,19,12,11,14,11,13,3,3,4,5,6,7,7,6,9,10,7,5,3,2,5,5,2,2,2,4,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,2,2,40,22,30,2,2,2,2,2,2,2,2,2,2,2,28,19,24,25,19,28,2,15,16,24,3,4,2,5,6,2,5,5,2,6,3,6,4,2,6,5,5,4,7,5,6,6,3,4,9,5,6,8,7,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,5,4,3,7,5,6,6,5,5,5,2,2,4,2,4,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,5,3,8,6,5,5,5,6,2,3,2,3,3,4,2,2,4,2,2,5,2,3,3,3,3,4,4,2,3,3,3,3,2,2,4,2,4,4,3,4,5,3,2,4,3,3,4,3,3,2,5,4,8,2,2,5,2,3,4,3,2,5,4,4,2,3,4]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"physics\":{\"stabilization\":false}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":false},\"byselection\":{\"enabled\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nVisit [Igraph](https://datastorm-open.github.io/visNetwork/) to find out more about visIgraphLayout’s argument.\n\n## 8.4 Working with visual attributes - Nodes\n\nvisNetwork() looks for a field called “group” in the nodes object and colour the nodes according to the values of the group field.\n\nThe code chunk below rename Department field to group.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGAStech_nodes <- GAStech_nodes %>%\n  rename(group = Department)\n```\n:::\n\n\nWhen we rerun the code chunk below, visNetwork shades the nodes by assigning unique colour to each category in the group field.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvisNetwork(GAStech_nodes,\n           GAStech_edges_aggregated) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visLegend() %>%\n  visLayout(randomSeed = 123)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-b3547885a5cd8d90d8af\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b3547885a5cd8d90d8af\">{\"x\":{\"nodes\":{\"id\":[1,2,3,4,5,6,7,44,45,46,8,9,10,11,12,13,14,15,16,21,26,17,18,19,20,39,40,41,42,43,27,28,29,47,48,49,50,22,51,52,53,54,23,24,25,30,31,32,33,34,35,36,37,38],\"label\":[\"Mat.Bramar\",\"Anda.Ribera\",\"Rachel.Pantanal\",\"Linda.Lagos\",\"Ruscella.Mies.Haber\",\"Carla.Forluniau\",\"Cornelia.Lais\",\"Kanon.Herrero\",\"Varja.Lagos\",\"Stenig.Fusil\",\"Marin.Onda\",\"Axel.Calzas\",\"Brand.Tempestad\",\"Elsa.Orilla\",\"Isande.Borrasca\",\"Kare.Orilla\",\"Felix.Balas\",\"Lars.Azada\",\"Lidelse.Dedos\",\"Willem.Vasco-Pais\",\"Bertrand.Ovan\",\"Adra.Nubarron\",\"Birgitta.Frente\",\"Gustav.Cazar\",\"Vira.Frente\",\"Linnea.Bergen\",\"Lucas.Alcazar\",\"Isak.Baza\",\"Nils.Calixto\",\"Sven.Flecha\",\"Emile.Arpa\",\"Varro.Awelon\",\"Dante.Coginian\",\"Edvard.Vann\",\"Hennie.Osvaldo\",\"Isia.Vann\",\"Minke.Mies\",\"Sten.Sanjorge.Jr\",\"Felix.Resumir\",\"Hideki.Cocinaro\",\"Inga.Ferro\",\"Loreto.Bodrogi\",\"Ingrid.Barranco\",\"Ada.Campo-Corrente\",\"Orhan.Strum\",\"Adan.Morlun\",\"Albina.Hafon\",\"Benito.Hawelon\",\"Cecilia.Morluniau\",\"Claudio.Hawelon\",\"Dylan.Scozzese\",\"Henk.Mies\",\"Irene.Nant\",\"Valeria.Morlun\"],\"group\":[\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Security\",\"Security\",\"Security\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Executive\",\"Facilities\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Facilities\",\"Facilities\",\"Facilities\",\"Security\",\"Security\",\"Security\",\"Security\",\"Executive\",\"Security\",\"Security\",\"Security\",\"Security\",\"Executive\",\"Executive\",\"Executive\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\"],\"Title\":[\"Assistant to CEO\",\"Assistant to CFO\",\"Assistant to CIO\",\"Assistant to COO\",\"Assistant to Engineering Group Manager\",\"Assistant to IT Group Manager\",\"Assistant to Security Group Manager\",\"Badging Office\",\"Badging Office\",\"Building Control\",\"Drill Site Manager\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Engineer\",\"Engineer\",\"Engineering Group Manager\",\"Environmental Safety Advisor\",\"Facilities Group Manager\",\"Geologist\",\"Geologist\",\"Hydraulic Technician\",\"Hydraulic Technician\",\"IT Group Manager\",\"IT Helpdesk\",\"IT Technician\",\"IT Technician\",\"IT Technician\",\"Janitor\",\"Janitor\",\"Lead Janitor\",\"Perimeter Control\",\"Perimeter Control\",\"Perimeter Control\",\"Perimeter Control\",\"President/CEO\",\"Security Group Manager\",\"Site Control\",\"Site Control\",\"Site Control\",\"SVP/CFO\",\"SVP/CIO\",\"SVP/COO\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\"],\"x\":[0.04846644132581179,0.4689357424123384,0.6800417931035885,0.9150132909356912,0.01300687437229242,0.8154852262838117,0.7954358396110179,0.5608185313903538,0.3047268610681868,-0.04165679823306612,-0.6881604475752398,-0.6375494097886329,-0.7736819957748948,-0.853557191577048,-0.4946109446470097,-1,-0.9156280987282337,-0.4525348558335655,-0.7047921531125447,-0.7402511793049251,-0.02882263178003286,-0.2218042514268949,-0.9490605983178774,-0.8226116354077092,-0.5114010820420845,1,-0.05336337314040485,0.683939928897997,0.7512718623492551,0.8104189565642987,-0.3058647488940653,0.3113820598998787,0.149430377894562,-0.07960857379154218,0.0172695034977377,0.5062707734132408,0.1393082025900525,-0.7931418993818566,0.4089526380371655,0.2441500035354258,0.01167458669105148,0.1375747990070377,-0.1883045504071502,-0.9226394167502454,-0.9839252730931368,-0.3355952182608091,0.1404375260284543,-0.4215000933323901,-0.2306171612796966,0.2583829491941261,-0.02680784123940183,-0.0943411172866806,-0.1754336191857863,0.1008456232317323],\"y\":[0.01174371088712256,-0.02287010849088422,-0.1412382291715587,-0.2265940316659687,-0.07530278468945151,0.02520287646565755,-0.4088279089979506,-0.6041149334628639,-0.8302636156548598,-0.7936445057734599,-0.2605281511291171,-0.5551603227742444,-0.660647118546005,-0.1997163454903772,-0.6740039351031435,-0.3808474903796034,-0.6942923588580246,-0.4825244815677475,-0.8152700127071983,0.177312440096028,1,-0.1124034049686794,-0.5303678788793221,-0.4117967930622722,-0.8283833454005097,0.2685444914872086,0.06756131219107386,0.5999092868178775,0.1932850180852572,0.4439918293102072,0.539669741287887,0.6483668105845508,0.4235958523393333,-0.1240931904174466,-0.1691191988517893,-0.813152362658931,-1,0.5314240542145638,-0.4644996292772778,-0.5768151170508393,-0.5095167999810506,-0.8412673104695019,0.04409985654422477,0.3629040784395965,0.1074124770912368,0.8309229657538915,0.8846525615813388,0.6627794345025684,0.9332181495967795,0.7996828888778897,0.8201984199638235,0.4897987048493435,0.7578354585516212,0.6583086165657659]},\"edges\":{\"from\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54],\"to\":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,3,4,5,6,7,15,36,38,1,2,4,5,6,7,48,1,2,3,5,6,7,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,2,3,4,5,7,28,1,2,3,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,27,8,10,11,12,13,14,15,16,17,18,19,20,45,8,9,11,12,13,14,15,16,17,18,19,20,8,9,10,12,13,14,15,16,17,18,19,20,32,8,9,10,11,13,14,15,16,17,18,19,20,52,8,9,10,11,12,14,15,16,17,18,19,20,8,9,10,11,12,13,15,16,17,18,19,20,2,8,9,10,11,12,13,14,16,17,18,19,20,8,9,10,11,12,13,14,15,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,8,9,10,11,12,13,14,15,17,19,20,8,9,10,11,12,13,14,15,16,17,18,20,8,9,10,11,12,13,14,15,16,17,18,19,50,22,23,24,25,53,21,23,24,25,36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,5,21,22,23,25,21,22,23,24,46,27,28,29,30,31,32,33,34,35,36,37,38,8,28,29,30,31,32,33,34,35,36,37,38,40,6,26,27,29,30,31,32,33,34,35,36,37,38,1,26,27,28,30,31,32,33,34,35,36,37,38,40,51,52,26,27,28,29,31,32,33,34,35,36,37,38,3,27,28,29,30,32,33,34,35,36,37,38,11,26,27,28,29,30,31,33,34,35,36,37,38,23,26,27,28,29,30,31,32,34,35,36,37,38,27,28,29,30,31,32,33,35,36,37,38,26,27,28,29,30,31,32,33,34,36,37,38,2,22,26,27,28,29,30,31,32,33,34,35,37,38,53,26,27,28,29,30,31,32,33,34,35,36,38,27,28,29,30,31,32,34,35,36,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,40,42,43,40,41,43,44,40,41,42,42,45,46,47,48,49,50,51,52,53,54,44,46,47,48,49,50,51,52,53,54,44,45,47,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,3,45,46,47,48,52,54,5,20,48,49,53,54,29,44,45,46,47,48,49,50,52,53,54,7,12,29,44,45,46,47,48,49,50,51,53,5,21,36,44,45,47,48,49,50,51,52,54,5,44,45,46,47,48,49,50,51,52,53],\"weight\":[21,21,21,21,21,21,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,6,6,6,6,6,9,2,2,2,8,8,8,8,8,8,2,12,12,12,12,12,12,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,11,11,11,11,11,11,3,12,15,12,12,12,12,3,4,3,3,4,4,3,3,4,3,4,3,3,4,4,9,4,7,7,11,5,4,5,6,8,3,8,8,7,9,9,6,9,10,10,7,5,7,11,10,11,6,11,7,11,9,10,7,10,8,3,9,10,8,8,11,6,7,5,3,6,5,6,2,9,5,10,7,7,4,3,4,7,2,3,3,6,5,7,4,6,6,7,5,7,6,3,4,3,6,13,8,8,5,6,6,11,9,6,2,7,6,8,7,5,5,7,6,7,7,5,4,6,2,2,2,2,2,2,2,6,4,7,7,6,6,6,6,5,5,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,5,3,3,2,5,2,3,2,4,8,5,9,6,5,4,10,7,4,4,5,5,10,5,7,4,5,4,4,4,3,2,4,3,4,2,4,7,2,7,5,10,4,2,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,6,10,17,9,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,5,9,7,3,8,2,3,4,2,26,25,25,25,25,25,24,25,25,26,25,26,3,4,3,6,4,3,3,6,5,3,4,5,3,3,2,3,6,5,8,6,6,7,4,6,6,6,2,2,6,5,7,5,6,5,7,6,6,5,5,3,2,3,3,5,7,9,12,9,9,6,13,12,9,11,2,5,4,6,6,9,7,6,12,7,7,8,4,2,8,6,9,7,10,7,9,6,10,5,8,2,4,2,3,5,7,8,4,7,5,7,6,4,5,6,4,7,8,5,9,6,6,10,6,3,11,7,9,11,15,7,11,11,9,13,13,2,2,3,12,11,12,16,15,19,12,11,14,11,13,3,3,4,5,6,7,7,6,9,10,7,5,3,2,5,5,2,2,2,4,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,2,2,40,22,30,2,2,2,2,2,2,2,2,2,2,2,28,19,24,25,19,28,2,15,16,24,3,4,2,5,6,2,5,5,2,6,3,6,4,2,6,5,5,4,7,5,6,6,3,4,9,5,6,8,7,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,5,4,3,7,5,6,6,5,5,5,2,2,4,2,4,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,5,3,8,6,5,5,5,6,2,3,2,3,3,4,2,2,4,2,2,5,2,3,3,3,3,4,4,2,3,3,3,3,2,2,4,2,4,4,3,4,5,3,2,4,3,3,4,3,3,2,5,4,8,2,2,5,2,3,4,3,2,5,4,4,2,3,4]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"physics\":{\"stabilization\":false},\"layout\":{\"randomSeed\":123}},\"groups\":[\"Administration\",\"Security\",\"Engineering\",\"Executive\",\"Facilities\",\"Information Technology\"],\"width\":null,\"height\":null,\"idselection\":{\"enabled\":false},\"byselection\":{\"enabled\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"},\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## 8.5 Working with visual attributes - Edges\n\nIn the code run below visEdges() is used to symbolise the edges.\n-   The argument arrows is used to define where to place the arrow.\n-   The smooth argument is used to plot the edges using a smooth curve.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvisNetwork(GAStech_nodes,\n           GAStech_edges_aggregated) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visEdges(arrows = \"to\", \n           smooth = list(enabled = TRUE, \n                         type = \"curvedCW\")) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 123)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-4ea4ae77f3cde7b9125d\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4ea4ae77f3cde7b9125d\">{\"x\":{\"nodes\":{\"id\":[1,2,3,4,5,6,7,44,45,46,8,9,10,11,12,13,14,15,16,21,26,17,18,19,20,39,40,41,42,43,27,28,29,47,48,49,50,22,51,52,53,54,23,24,25,30,31,32,33,34,35,36,37,38],\"label\":[\"Mat.Bramar\",\"Anda.Ribera\",\"Rachel.Pantanal\",\"Linda.Lagos\",\"Ruscella.Mies.Haber\",\"Carla.Forluniau\",\"Cornelia.Lais\",\"Kanon.Herrero\",\"Varja.Lagos\",\"Stenig.Fusil\",\"Marin.Onda\",\"Axel.Calzas\",\"Brand.Tempestad\",\"Elsa.Orilla\",\"Isande.Borrasca\",\"Kare.Orilla\",\"Felix.Balas\",\"Lars.Azada\",\"Lidelse.Dedos\",\"Willem.Vasco-Pais\",\"Bertrand.Ovan\",\"Adra.Nubarron\",\"Birgitta.Frente\",\"Gustav.Cazar\",\"Vira.Frente\",\"Linnea.Bergen\",\"Lucas.Alcazar\",\"Isak.Baza\",\"Nils.Calixto\",\"Sven.Flecha\",\"Emile.Arpa\",\"Varro.Awelon\",\"Dante.Coginian\",\"Edvard.Vann\",\"Hennie.Osvaldo\",\"Isia.Vann\",\"Minke.Mies\",\"Sten.Sanjorge.Jr\",\"Felix.Resumir\",\"Hideki.Cocinaro\",\"Inga.Ferro\",\"Loreto.Bodrogi\",\"Ingrid.Barranco\",\"Ada.Campo-Corrente\",\"Orhan.Strum\",\"Adan.Morlun\",\"Albina.Hafon\",\"Benito.Hawelon\",\"Cecilia.Morluniau\",\"Claudio.Hawelon\",\"Dylan.Scozzese\",\"Henk.Mies\",\"Irene.Nant\",\"Valeria.Morlun\"],\"group\":[\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Security\",\"Security\",\"Security\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Executive\",\"Facilities\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Facilities\",\"Facilities\",\"Facilities\",\"Security\",\"Security\",\"Security\",\"Security\",\"Executive\",\"Security\",\"Security\",\"Security\",\"Security\",\"Executive\",\"Executive\",\"Executive\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\"],\"Title\":[\"Assistant to CEO\",\"Assistant to CFO\",\"Assistant to CIO\",\"Assistant to COO\",\"Assistant to Engineering Group Manager\",\"Assistant to IT Group Manager\",\"Assistant to Security Group Manager\",\"Badging Office\",\"Badging Office\",\"Building Control\",\"Drill Site Manager\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Engineer\",\"Engineer\",\"Engineering Group Manager\",\"Environmental Safety Advisor\",\"Facilities Group Manager\",\"Geologist\",\"Geologist\",\"Hydraulic Technician\",\"Hydraulic Technician\",\"IT Group Manager\",\"IT Helpdesk\",\"IT Technician\",\"IT Technician\",\"IT Technician\",\"Janitor\",\"Janitor\",\"Lead Janitor\",\"Perimeter Control\",\"Perimeter Control\",\"Perimeter Control\",\"Perimeter Control\",\"President/CEO\",\"Security Group Manager\",\"Site Control\",\"Site Control\",\"Site Control\",\"SVP/CFO\",\"SVP/CIO\",\"SVP/COO\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\"],\"x\":[0.1111766407971906,-0.196356043358291,-0.4290540415958992,-0.6604003724222116,-0.05508084853354944,-0.4135822273179505,-0.5839001687142633,-0.6141343986942509,-0.5461568987514316,-0.7732828427298312,0.9494689411364241,0.4520093512411956,0.9896002200643053,0.7562071189243558,0.4957535250719411,0.8618399776229049,0.7695526314634591,0.6150640135416228,0.6060785525707506,-0.89743512733977,0.2349050451199066,0.2365874703186128,1,0.8820018364707305,0.6632251570767129,-0.2624749489647145,0.1196080667763271,-0.05422992628336243,-0.2918967420618411,0.1599297010255358,0.7784985643928062,0.171578439037432,0.2836565701630791,-0.06981512693914738,0.01018496700394489,-0.7584254510171848,-0.1577653918395079,-0.7880226731201455,-0.4953308855649655,-0.284217779812393,-0.5647874028345221,-0.4092690306634578,0.003029175665857364,-0.9504476384528125,-1,0.3715093544308186,0.6332668075389007,0.629625048592009,0.5086299956106894,0.5207051891583949,0.7852753310866023,0.08558931021755312,0.6326504969267381,0.3638336277027083],\"y\":[-0.06411301115661761,-0.4867066619878794,-0.5243269973146683,-0.6343438356937543,-0.03132755994862613,-0.7558822312284428,-0.3424153456577176,0.7252269051334936,0.5686458958946303,0.5210447171622419,0.1544659202337963,0.6824672802091529,0.3808902364490203,0.377797224214083,0.5015788286273892,0.277440172108472,0.7614804825738353,0.2418633651039839,0.747413082844546,-0.06668695633900779,-0.7785250505356585,0.09439920235824095,0.5239323681800203,0.6281683303186014,0.5840854129935198,-1,0.07911501825985678,1,0.9763807487095666,0.9994219827314936,-0.4600184124950705,-0.9034208568680113,-0.4022488030463161,0.07825296536707049,0.1182675957484605,0.3269231286693384,0.6720345804166699,-0.3921999936226911,0.3201626047691151,0.4030707225355881,0.1455848089003182,0.6654503578824658,-0.08406062034549455,-0.2490836839420646,0.09396290667312557,-0.9105100208888247,-0.8026368155568555,-0.4009752495795281,-0.701260869105666,-0.9187573976505727,-0.6886566366912175,-0.6118132198944174,-0.587597893143697,-0.6307902645904402]},\"edges\":{\"from\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54],\"to\":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,3,4,5,6,7,15,36,38,1,2,4,5,6,7,48,1,2,3,5,6,7,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,2,3,4,5,7,28,1,2,3,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,27,8,10,11,12,13,14,15,16,17,18,19,20,45,8,9,11,12,13,14,15,16,17,18,19,20,8,9,10,12,13,14,15,16,17,18,19,20,32,8,9,10,11,13,14,15,16,17,18,19,20,52,8,9,10,11,12,14,15,16,17,18,19,20,8,9,10,11,12,13,15,16,17,18,19,20,2,8,9,10,11,12,13,14,16,17,18,19,20,8,9,10,11,12,13,14,15,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,8,9,10,11,12,13,14,15,17,19,20,8,9,10,11,12,13,14,15,16,17,18,20,8,9,10,11,12,13,14,15,16,17,18,19,50,22,23,24,25,53,21,23,24,25,36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,5,21,22,23,25,21,22,23,24,46,27,28,29,30,31,32,33,34,35,36,37,38,8,28,29,30,31,32,33,34,35,36,37,38,40,6,26,27,29,30,31,32,33,34,35,36,37,38,1,26,27,28,30,31,32,33,34,35,36,37,38,40,51,52,26,27,28,29,31,32,33,34,35,36,37,38,3,27,28,29,30,32,33,34,35,36,37,38,11,26,27,28,29,30,31,33,34,35,36,37,38,23,26,27,28,29,30,31,32,34,35,36,37,38,27,28,29,30,31,32,33,35,36,37,38,26,27,28,29,30,31,32,33,34,36,37,38,2,22,26,27,28,29,30,31,32,33,34,35,37,38,53,26,27,28,29,30,31,32,33,34,35,36,38,27,28,29,30,31,32,34,35,36,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,40,42,43,40,41,43,44,40,41,42,42,45,46,47,48,49,50,51,52,53,54,44,46,47,48,49,50,51,52,53,54,44,45,47,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,3,45,46,47,48,52,54,5,20,48,49,53,54,29,44,45,46,47,48,49,50,52,53,54,7,12,29,44,45,46,47,48,49,50,51,53,5,21,36,44,45,47,48,49,50,51,52,54,5,44,45,46,47,48,49,50,51,52,53],\"weight\":[21,21,21,21,21,21,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,6,6,6,6,6,9,2,2,2,8,8,8,8,8,8,2,12,12,12,12,12,12,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,11,11,11,11,11,11,3,12,15,12,12,12,12,3,4,3,3,4,4,3,3,4,3,4,3,3,4,4,9,4,7,7,11,5,4,5,6,8,3,8,8,7,9,9,6,9,10,10,7,5,7,11,10,11,6,11,7,11,9,10,7,10,8,3,9,10,8,8,11,6,7,5,3,6,5,6,2,9,5,10,7,7,4,3,4,7,2,3,3,6,5,7,4,6,6,7,5,7,6,3,4,3,6,13,8,8,5,6,6,11,9,6,2,7,6,8,7,5,5,7,6,7,7,5,4,6,2,2,2,2,2,2,2,6,4,7,7,6,6,6,6,5,5,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,5,3,3,2,5,2,3,2,4,8,5,9,6,5,4,10,7,4,4,5,5,10,5,7,4,5,4,4,4,3,2,4,3,4,2,4,7,2,7,5,10,4,2,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,6,10,17,9,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,5,9,7,3,8,2,3,4,2,26,25,25,25,25,25,24,25,25,26,25,26,3,4,3,6,4,3,3,6,5,3,4,5,3,3,2,3,6,5,8,6,6,7,4,6,6,6,2,2,6,5,7,5,6,5,7,6,6,5,5,3,2,3,3,5,7,9,12,9,9,6,13,12,9,11,2,5,4,6,6,9,7,6,12,7,7,8,4,2,8,6,9,7,10,7,9,6,10,5,8,2,4,2,3,5,7,8,4,7,5,7,6,4,5,6,4,7,8,5,9,6,6,10,6,3,11,7,9,11,15,7,11,11,9,13,13,2,2,3,12,11,12,16,15,19,12,11,14,11,13,3,3,4,5,6,7,7,6,9,10,7,5,3,2,5,5,2,2,2,4,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,2,2,40,22,30,2,2,2,2,2,2,2,2,2,2,2,28,19,24,25,19,28,2,15,16,24,3,4,2,5,6,2,5,5,2,6,3,6,4,2,6,5,5,4,7,5,6,6,3,4,9,5,6,8,7,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,5,4,3,7,5,6,6,5,5,5,2,2,4,2,4,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,5,3,8,6,5,5,5,6,2,3,2,3,3,4,2,2,4,2,2,5,2,3,3,3,3,4,4,2,3,3,3,3,2,2,4,2,4,4,3,4,5,3,2,4,3,3,4,3,3,2,5,4,8,2,2,5,2,3,4,3,2,5,4,4,2,3,4]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":\"to\",\"smooth\":{\"enabled\":true,\"type\":\"curvedCW\"}},\"physics\":{\"stabilization\":false},\"layout\":{\"randomSeed\":123}},\"groups\":[\"Administration\",\"Security\",\"Engineering\",\"Executive\",\"Facilities\",\"Information Technology\"],\"width\":null,\"height\":null,\"idselection\":{\"enabled\":false},\"byselection\":{\"enabled\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"},\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nVisit [Option](https://datastorm-open.github.io/visNetwork/edges.html) to find out more about visEdges’s argument.\n\n\n## 8.6 Interactivity\n\nIn the code chunk below, `visOptions()` is used to incorporate interactivity features in the data visualisation.\n\n-   The argument *highlightNearest* highlights nearest when clicking a node.\n-   The argument *nodesIdSelection* adds an id node selection creating an HTML select element.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvisNetwork(GAStech_nodes,\n           GAStech_edges_aggregated) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visOptions(highlightNearest = TRUE,\n             nodesIdSelection = TRUE) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 123)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-d5f60b3027ea1df3052a\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d5f60b3027ea1df3052a\">{\"x\":{\"nodes\":{\"id\":[1,2,3,4,5,6,7,44,45,46,8,9,10,11,12,13,14,15,16,21,26,17,18,19,20,39,40,41,42,43,27,28,29,47,48,49,50,22,51,52,53,54,23,24,25,30,31,32,33,34,35,36,37,38],\"label\":[\"Mat.Bramar\",\"Anda.Ribera\",\"Rachel.Pantanal\",\"Linda.Lagos\",\"Ruscella.Mies.Haber\",\"Carla.Forluniau\",\"Cornelia.Lais\",\"Kanon.Herrero\",\"Varja.Lagos\",\"Stenig.Fusil\",\"Marin.Onda\",\"Axel.Calzas\",\"Brand.Tempestad\",\"Elsa.Orilla\",\"Isande.Borrasca\",\"Kare.Orilla\",\"Felix.Balas\",\"Lars.Azada\",\"Lidelse.Dedos\",\"Willem.Vasco-Pais\",\"Bertrand.Ovan\",\"Adra.Nubarron\",\"Birgitta.Frente\",\"Gustav.Cazar\",\"Vira.Frente\",\"Linnea.Bergen\",\"Lucas.Alcazar\",\"Isak.Baza\",\"Nils.Calixto\",\"Sven.Flecha\",\"Emile.Arpa\",\"Varro.Awelon\",\"Dante.Coginian\",\"Edvard.Vann\",\"Hennie.Osvaldo\",\"Isia.Vann\",\"Minke.Mies\",\"Sten.Sanjorge.Jr\",\"Felix.Resumir\",\"Hideki.Cocinaro\",\"Inga.Ferro\",\"Loreto.Bodrogi\",\"Ingrid.Barranco\",\"Ada.Campo-Corrente\",\"Orhan.Strum\",\"Adan.Morlun\",\"Albina.Hafon\",\"Benito.Hawelon\",\"Cecilia.Morluniau\",\"Claudio.Hawelon\",\"Dylan.Scozzese\",\"Henk.Mies\",\"Irene.Nant\",\"Valeria.Morlun\"],\"group\":[\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Administration\",\"Security\",\"Security\",\"Security\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Executive\",\"Facilities\",\"Engineering\",\"Engineering\",\"Engineering\",\"Engineering\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Information Technology\",\"Facilities\",\"Facilities\",\"Facilities\",\"Security\",\"Security\",\"Security\",\"Security\",\"Executive\",\"Security\",\"Security\",\"Security\",\"Security\",\"Executive\",\"Executive\",\"Executive\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\",\"Facilities\"],\"Title\":[\"Assistant to CEO\",\"Assistant to CFO\",\"Assistant to CIO\",\"Assistant to COO\",\"Assistant to Engineering Group Manager\",\"Assistant to IT Group Manager\",\"Assistant to Security Group Manager\",\"Badging Office\",\"Badging Office\",\"Building Control\",\"Drill Site Manager\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Drill Technician\",\"Engineer\",\"Engineer\",\"Engineering Group Manager\",\"Environmental Safety Advisor\",\"Facilities Group Manager\",\"Geologist\",\"Geologist\",\"Hydraulic Technician\",\"Hydraulic Technician\",\"IT Group Manager\",\"IT Helpdesk\",\"IT Technician\",\"IT Technician\",\"IT Technician\",\"Janitor\",\"Janitor\",\"Lead Janitor\",\"Perimeter Control\",\"Perimeter Control\",\"Perimeter Control\",\"Perimeter Control\",\"President/CEO\",\"Security Group Manager\",\"Site Control\",\"Site Control\",\"Site Control\",\"SVP/CFO\",\"SVP/CIO\",\"SVP/COO\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\",\"Truck Driver\"],\"x\":[-0.07264619172797038,-0.113734343112788,0.05056282043660176,-0.002205918409484697,0.02721251805305358,-0.2263975029117005,0.2571577198106401,0.9501739777425633,0.9642424191441406,1,-0.3522665873579961,0.2285057819754504,-0.04388204954175334,-0.4618872941745088,0.06758578331550091,-0.2323273488669731,-0.05264449079803557,-0.1556938270907057,0.1127510674961554,0.5608175292877731,-1,-0.04546556239522903,-0.2270307745590372,-0.3765880424836595,0.1993286755774615,-0.9235826987728973,0.01499162172967972,0.6639006959573384,0.9398721908508767,0.7322036350281025,-0.6616581534193386,-0.6208299554324803,-0.404235457126131,0.1383583009940232,0.1667127783858564,0.8607665205188111,0.7138959961764055,0.2973766640178066,0.6538182122786969,0.5688816246539306,0.5671940147789076,0.8342011375589515,0.04909546410618071,0.7692723829031369,0.6307374982142142,-0.9065777910580943,-0.819889763422003,-0.842917108827733,-0.7995426221172188,-0.9793743075900992,-0.6692078350062332,-0.4185376244621239,-0.628261775054302,-0.7662321315738296],\"y\":[-0.08523469633082936,-0.5903832866965754,-0.7438086546442113,-0.9972104039275378,-0.1750512791609257,-0.9247694613295472,-0.7748594598824154,0.155945699637738,-0.0002505954096657659,-0.2525521330430961,0.588847940082877,0.6856703185390147,0.8150757318350139,0.690058022493877,0.6206908548922037,0.9689295547320194,1,0.5174149213587824,0.9702989011264149,-0.7693217173167154,-0.3844361770172448,0.1410232038505428,0.7676826302305395,0.8747412984831859,0.8246586062941867,0.4513799965570848,0.04563373664004255,0.7853143434335748,0.4970165078184847,0.6047508942639379,-0.03124393612066945,-0.4977241361391641,-0.2951787664159987,0.01741370625287231,-0.07439495772316917,-0.3891094133502064,0.2415705993954913,-1,-0.232409704077387,-0.01699443538977041,-0.3874874869913826,-0.09324845911605606,-0.09782131788551673,-0.7043240522835773,-0.9258239393175688,-0.5527350346508259,-0.2334633298875198,-0.01343891723967927,-0.3991841920165453,-0.1634662221237636,-0.2540679946429552,-0.5675503741940061,-0.6823037906541398,-0.6469245881673863]},\"edges\":{\"from\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54],\"to\":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,3,4,5,6,7,15,36,38,1,2,4,5,6,7,48,1,2,3,5,6,7,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,2,3,4,5,7,28,1,2,3,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,27,8,10,11,12,13,14,15,16,17,18,19,20,45,8,9,11,12,13,14,15,16,17,18,19,20,8,9,10,12,13,14,15,16,17,18,19,20,32,8,9,10,11,13,14,15,16,17,18,19,20,52,8,9,10,11,12,14,15,16,17,18,19,20,8,9,10,11,12,13,15,16,17,18,19,20,2,8,9,10,11,12,13,14,16,17,18,19,20,8,9,10,11,12,13,14,15,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,8,9,10,11,12,13,14,15,17,19,20,8,9,10,11,12,13,14,15,16,17,18,20,8,9,10,11,12,13,14,15,16,17,18,19,50,22,23,24,25,53,21,23,24,25,36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,5,21,22,23,25,21,22,23,24,46,27,28,29,30,31,32,33,34,35,36,37,38,8,28,29,30,31,32,33,34,35,36,37,38,40,6,26,27,29,30,31,32,33,34,35,36,37,38,1,26,27,28,30,31,32,33,34,35,36,37,38,40,51,52,26,27,28,29,31,32,33,34,35,36,37,38,3,27,28,29,30,32,33,34,35,36,37,38,11,26,27,28,29,30,31,33,34,35,36,37,38,23,26,27,28,29,30,31,32,34,35,36,37,38,27,28,29,30,31,32,33,35,36,37,38,26,27,28,29,30,31,32,33,34,36,37,38,2,22,26,27,28,29,30,31,32,33,34,35,37,38,53,26,27,28,29,30,31,32,33,34,35,36,38,27,28,29,30,31,32,34,35,36,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,40,42,43,40,41,43,44,40,41,42,42,45,46,47,48,49,50,51,52,53,54,44,46,47,48,49,50,51,52,53,54,44,45,47,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,3,45,46,47,48,52,54,5,20,48,49,53,54,29,44,45,46,47,48,49,50,52,53,54,7,12,29,44,45,46,47,48,49,50,51,53,5,21,36,44,45,47,48,49,50,51,52,54,5,44,45,46,47,48,49,50,51,52,53],\"weight\":[21,21,21,21,21,21,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,6,6,6,6,6,9,2,2,2,8,8,8,8,8,8,2,12,12,12,12,12,12,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,11,11,11,11,11,11,3,12,15,12,12,12,12,3,4,3,3,4,4,3,3,4,3,4,3,3,4,4,9,4,7,7,11,5,4,5,6,8,3,8,8,7,9,9,6,9,10,10,7,5,7,11,10,11,6,11,7,11,9,10,7,10,8,3,9,10,8,8,11,6,7,5,3,6,5,6,2,9,5,10,7,7,4,3,4,7,2,3,3,6,5,7,4,6,6,7,5,7,6,3,4,3,6,13,8,8,5,6,6,11,9,6,2,7,6,8,7,5,5,7,6,7,7,5,4,6,2,2,2,2,2,2,2,6,4,7,7,6,6,6,6,5,5,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,5,3,3,2,5,2,3,2,4,8,5,9,6,5,4,10,7,4,4,5,5,10,5,7,4,5,4,4,4,3,2,4,3,4,2,4,7,2,7,5,10,4,2,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,6,10,17,9,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,5,9,7,3,8,2,3,4,2,26,25,25,25,25,25,24,25,25,26,25,26,3,4,3,6,4,3,3,6,5,3,4,5,3,3,2,3,6,5,8,6,6,7,4,6,6,6,2,2,6,5,7,5,6,5,7,6,6,5,5,3,2,3,3,5,7,9,12,9,9,6,13,12,9,11,2,5,4,6,6,9,7,6,12,7,7,8,4,2,8,6,9,7,10,7,9,6,10,5,8,2,4,2,3,5,7,8,4,7,5,7,6,4,5,6,4,7,8,5,9,6,6,10,6,3,11,7,9,11,15,7,11,11,9,13,13,2,2,3,12,11,12,16,15,19,12,11,14,11,13,3,3,4,5,6,7,7,6,9,10,7,5,3,2,5,5,2,2,2,4,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,2,2,40,22,30,2,2,2,2,2,2,2,2,2,2,2,28,19,24,25,19,28,2,15,16,24,3,4,2,5,6,2,5,5,2,6,3,6,4,2,6,5,5,4,7,5,6,6,3,4,9,5,6,8,7,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,5,4,3,7,5,6,6,5,5,5,2,2,4,2,4,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,5,3,8,6,5,5,5,6,2,3,2,3,3,4,2,2,4,2,2,5,2,3,3,3,3,4,4,2,3,3,3,3,2,2,4,2,4,4,3,4,5,3,2,4,3,3,4,3,3,2,5,4,8,2,2,5,2,3,4,3,2,5,4,4,2,3,4]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"physics\":{\"stabilization\":false},\"layout\":{\"randomSeed\":123}},\"groups\":[\"Administration\",\"Security\",\"Engineering\",\"Executive\",\"Facilities\",\"Information Technology\"],\"width\":null,\"height\":null,\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nVisit [Option](https://datastorm-open.github.io/visNetwork/options.html) to find out more about visOption’s argument.\n",
    "supporting": [
      "Hands-on_Ex06_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\r\n<link href=\"../../site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/vis-9.1.0/vis-network.min.js\"></script>\r\n<script src=\"../../site_libs/visNetwork-binding-2.1.2/visNetwork.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}